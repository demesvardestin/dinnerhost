<%= simple_form_for(@article, :html => { :class => '', :id => "new_article", :multipart => true, authenticity_token: true }) do |f| %>
  <% if @article.errors.any? %>
    <div id="error_explanation">
        <h2>This post could not be saved due to the following <%= pluralize(@article.errors.count, "error") %>:</h2>

        <ul>
            <% @article.errors.full_messages.each do |message| %>
                <li><%= message %></li>
            <% end %>
        </ul>
    </div>
  <% end %>
  
  <input type="hidden" name="article[admin_id]" value="1">
  <input type="hidden" name="article[author]" value="Cee Burke">
  <input type="hidden" name="article[category]" id="article_category" value="">
  <input type="hidden" name="article[banner_image]" value="https://s3.us-east-2.amazonaws.com/senzzu/stores_banner.png">
  <div class="field col-md-12">
    <%= f.input :title, class:"form-control no-box-shadow height-55 font-15 pf", autofocus: true, placeholder:"Post title", label: false %>
  </div>
  
  <div class="field col-md-12">
    <%= f.input :content, class:"form-control no-box-shadow font-15 pf post-body", placeholder:"Post body", as: :wysihtml5, label: false %>
  </div>
  
  <div class="col-md-12">
    <div class="row">
      <div class="field col-md-8">
        <%= f.input :tags, class:"form-control no-box-shadow height-55 font-16 pf", placeholder:"Add tags, separated by a comma", label: false %>
      </div>
      
      <div class="field col-md-4">
        <button class="btn btn-primary btn-flat btn-block set-category-post-category height-55" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          Select a category <i class="fa fa-angle-down"></i>
        </button>
        <div class="dropdown-menu" style="width: 100%; margin-top: 225px;" aria-labelledby="dropdownMenuButton">
          <% post_categories.each do |c| %>
              <a class="dropdown-item theme-blue cursor-pointer" id="category-<%= c %>" onclick="setCategory(this, 'article_category', 'post-category')"><%= c %></a>
              <div class="dropdown-divider"></div>
          <% end %>
        </div>
      </div>
    </div>
  </div>
  
  <div class="actions text-center">
    <%= f.button :submit, "Create post!", class:"btn btn-primary height-55", id:"create_article", data: { "disable-with": "Creating..." } %>
  </div>
<% end %>

<script>
  function setCategory(elem, inputID, context) {
    var id = elem.id;
    var category = id.split('-')[1]
    document.getElementById(inputID).value = category;
    $('.set-category-' + context).html(
        category + ' <i class="fa fa-angle-down"></i>'
    );
  }
</script>