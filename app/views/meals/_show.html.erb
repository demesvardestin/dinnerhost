<section class="meal-page">
    <section id="meal-banner-image" style="background-image: url('<%= @meal.image.url %>');
        background-position: center; background-size: cover; height: 300px;
        "></section>
    <span id='meal-id' class="no-display"><%= @meal.id %></span>
    
    <div class="container" style="margin-top: 25px;">
        <div class="row">
            <div class="col-md-7">
                <div class="row">
                    <div class="col-md-12">
                        <h3 class="bold"><%= @meal.name %></h3>
                        <h5>
                            <a href="/category/<%= @meal.meal_type.downcase %>"
                                class="background-transparent no-underline theme-cyan">
                                <%= @meal.meal_type %>
                            </a>
                        </h5>
                    </div>
                </div>
                <div class="row add-margin-top">
                    <div class="col-md-12">
                        <div class="card">
                            <div class="card-body">
                                <p>
                                    This dish is generally considered a(n)
                                    <%= @meal.dish_order.downcase %>, is served
                                    <%= @meal.serving_temperature %>, and has
                                    <%= @meal.allergen_list %>.
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row" style="margin-top: 20px;">
                    <div class="col-md-12">
                        <p class="font-15"><%= @meal.description %></p>
                    </div>
                </div>
                
                <hr>
                
                <div class="row" style="margin-top: 20px;">
                    <div class="col-md-12">
                        <% @meal.tags_list.each do |t| %>
                            <a href="/tagged/<%= t.split('#').join('') %>"
                                class="background-transparent no-underline">
                                <span class="font-15 badge badge-primary"
                                    style="margin-right: 3px; margin-bottom: 5px;">
                                    <%= t %>
                                </span>
                            </a>
                        <% end %>
                    </div>
                </div>
                
                <hr>
                
                <div class="add-margin-top">
                    <div class="row">
                        <div class="col-md-6">
                            <h4 class="bold add-margin-top">
                                <%= pluralize(@meal.rating_count, 'Review') %>
                                <span class="cook-rating cursor-pointer" align="center"
                                    <% if current_customer && current_customer.has_not_rated(@meal) %>
                                    data-toggle="modal" data-target="#rateMeal"<% end %>
                                    style="margin-left: 10px;">
                                    <% 5.times.each_with_index do |s, idx| %>
                                        <span class="star">
                                            <i class="<%= meal_star_rating(idx + 1, @meal) %> theme-cyan"
                                                style="font-size: 23px;"></i>
                                        </span>
                                    <% end %>
                                </span>
                            </h4>
                        </div>
                        <div class="col-md-5 offset-md-1" align="right">
                            <input type="text" class="form-control no-box-shadow" id="meal-review-search"
                                placeholder="Search reviews" onkeyup="searchReviews(this)">
                        </div>
                    </div>
                </div>
                
                <hr>
                
                <div class="add-margin-top" id="reviews-section">
                    <div id="reviews">
                        <%= render partial: "common/reviews", locals: { reviews: @reviews.first(5) } %>
                    </div>
                    
                    <div id="reviewButtons">
                        <%= render partial: "review_buttons", locals: { reviews: @reviews } %>
                    </div>
                    
                    <hr>
                </div>
            </div>
            <div class="col-md-3 offset-md-2">
                <% if current_chef %>
                    <% if @meal.chef == current_chef %>
                        <%= render 'meal_owner' %>
                    <% end %>
                <% else %>
                    <%= render 'prepared_by' %>
                <% end %>
            </div>
        </div>
        
        <div class="row" style="margin-top: 20px;">
            <div class="col-md-12">
                <h4 class="bold">More dishes you may like</h4>
            </div>
        </div>
    </div>
</section>
